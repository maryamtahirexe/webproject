{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{updateOwner,clearMessage,clearError,fetchOwner}from\"../../redux/slices/updateSlice/updateSlice\";import Button from\"../../components/Button/button\";import Popup from\"reactjs-popup\";import\"reactjs-popup/dist/index.css\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilePage=()=>{const[email,setEmail]=useState(\"\");const[newPassword,setNewPassword]=useState(\"\");const[oldPassword,setOldPassword]=useState(\"\");const[popupMessage,setPopupMessage]=useState(null);const[showConfirmation,setShowConfirmation]=useState(false);const navigate=useNavigate();const dispatch=useDispatch();const{loading,message,error,owner}=useSelector(state=>state.update);useEffect(()=>{dispatch(fetchOwner());},[dispatch]);useEffect(()=>{if(owner){setEmail(owner.email);setOldPassword(owner.password);}},[owner]);useEffect(()=>{if(message){setPopupMessage(message);dispatch(clearMessage());}if(error){setPopupMessage(error);dispatch(clearError());}},[message,error,dispatch]);const handleUpdate=()=>{setShowConfirmation(true);};const confirmUpdate=async()=>{try{const passwordToUpdate=newPassword||oldPassword;const response=await dispatch(updateOwner({email,newPassword:passwordToUpdate})).unwrap();if(response.status===\"success\"){setPopupMessage(\"Profile updated successfully\");setTimeout(()=>setPopupMessage(null),3000);}else{setPopupMessage(response.message||\"Failed to update profile\");}setShowConfirmation(false);navigate(\"/dashboard\");}catch(error){console.error(\"Error updating profile:\",error);setPopupMessage(error.message||\"Failed to update profile\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 m-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl mb-4 font-bold text-primary text-center\",children:\"Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-primary mb-2\",htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"email\",value:email,onChange:e=>setEmail(e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:border-primary\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-primary mb-2\",htmlFor:\"oldPassword\",children:\"Old Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"oldPassword\",value:oldPassword,disabled:true,className:\"w-full p-2 border border-gray-300 rounded-md bg-gray-100 focus:outline-none\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-primary mb-2\",htmlFor:\"newPassword\",children:\"New Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newPassword\",value:newPassword,onChange:e=>setNewPassword(e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:border-primary\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center space-x-7 mt-3\",children:[/*#__PURE__*/_jsx(Button,{text:loading?\"Updating...\":\"Update\",onClick:handleUpdate,disabled:loading,className:\"px-6 py-3\"}),/*#__PURE__*/_jsx(Button,{text:\"Cancel\",onClick:()=>navigate(-1),variant:\"secondary\",className:\"px-6 py-2\"})]}),popupMessage&&/*#__PURE__*/_jsx(Popup,{open:true,onClose:()=>setPopupMessage(null),closeOnDocumentClick:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full text-center p-4 rounded-lg shadow-lg\",children:[popupMessage,/*#__PURE__*/_jsx(Button,{text:\"OK\",onClick:()=>setPopupMessage(null)})]})}),showConfirmation&&/*#__PURE__*/_jsx(Popup,{open:true,onClose:()=>setShowConfirmation(false),closeOnDocumentClick:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full text-center p-4 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to change your password?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 gap-x-4 flex justify-around\",children:[/*#__PURE__*/_jsx(Button,{text:\"Confirm\",onClick:confirmUpdate}),/*#__PURE__*/_jsx(Button,{text:\"Cancel\",onClick:()=>setShowConfirmation(false)})]})]})})]});};export default ProfilePage;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","updateOwner","clearMessage","clearError","fetchOwner","Button","Popup","useNavigate","jsx","_jsx","jsxs","_jsxs","ProfilePage","email","setEmail","newPassword","setNewPassword","oldPassword","setOldPassword","popupMessage","setPopupMessage","showConfirmation","setShowConfirmation","navigate","dispatch","loading","message","error","owner","state","update","password","handleUpdate","confirmUpdate","passwordToUpdate","response","unwrap","status","setTimeout","console","className","children","htmlFor","type","id","value","onChange","e","target","disabled","text","onClick","variant","open","onClose","closeOnDocumentClick"],"sources":["C:/Users/Fahad/Downloads/webb/webproject/my-app/src/pages/Profile/updateProfile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  updateOwner,\r\n  clearMessage,\r\n  clearError,\r\n  fetchOwner,\r\n} from \"../../redux/slices/updateSlice/updateSlice\";\r\nimport Button from \"../../components/Button/button\";\r\nimport Popup from \"reactjs-popup\";\r\nimport \"reactjs-popup/dist/index.css\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst ProfilePage = () => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [newPassword, setNewPassword] = useState(\"\");\r\n  const [oldPassword, setOldPassword] = useState(\"\");\r\n  const [popupMessage, setPopupMessage] = useState(null);\r\n  const [showConfirmation, setShowConfirmation] = useState(false);\r\n\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const { loading, message, error, owner } = useSelector(\r\n    (state) => state.update\r\n  );\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchOwner());\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (owner) {\r\n      setEmail(owner.email);\r\n      setOldPassword(owner.password);\r\n    }\r\n  }, [owner]);\r\n\r\n  useEffect(() => {\r\n    if (message) {\r\n      setPopupMessage(message);\r\n      dispatch(clearMessage());\r\n    }\r\n    if (error) {\r\n      setPopupMessage(error);\r\n      dispatch(clearError());\r\n    }\r\n  }, [message, error, dispatch]);\r\n\r\n  const handleUpdate = () => {\r\n    setShowConfirmation(true);\r\n  };\r\n\r\n  const confirmUpdate = async () => {\r\n    try {\r\n      const passwordToUpdate = newPassword || oldPassword;\r\n\r\n      const response = await dispatch(\r\n        updateOwner({ email, newPassword: passwordToUpdate })\r\n      ).unwrap();\r\n\r\n      if (response.status === \"success\") {\r\n        setPopupMessage(\"Profile updated successfully\");\r\n        setTimeout(() => setPopupMessage(null), 3000);\r\n      } else {\r\n        setPopupMessage(response.message || \"Failed to update profile\");\r\n      }\r\n\r\n      setShowConfirmation(false);\r\n      navigate(\"/dashboard\");\r\n    } catch (error) {\r\n      console.error(\"Error updating profile:\", error);\r\n      setPopupMessage(error.message || \"Failed to update profile\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 m-2\">\r\n      <h1 className=\"text-3xl mb-4 font-bold text-primary text-center\">\r\n        Profile\r\n      </h1>\r\n      <div className=\"mb-4\">\r\n        <label className=\"block text-primary mb-2\" htmlFor=\"email\">\r\n          Email\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"email\"\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n          className=\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:border-primary\"\r\n        />\r\n      </div>\r\n      <div className=\"mb-4\">\r\n        <label className=\"block text-primary mb-2\" htmlFor=\"oldPassword\">\r\n          Old Password\r\n        </label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"oldPassword\"\r\n          value={oldPassword}\r\n          disabled\r\n          className=\"w-full p-2 border border-gray-300 rounded-md bg-gray-100 focus:outline-none\"\r\n        />\r\n      </div>\r\n      <div className=\"mb-6\">\r\n        <label className=\"block text-primary mb-2\" htmlFor=\"newPassword\">\r\n          New Password\r\n        </label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"newPassword\"\r\n          value={newPassword}\r\n          onChange={(e) => setNewPassword(e.target.value)}\r\n          className=\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:border-primary\"\r\n        />\r\n      </div>\r\n      <div className=\"flex justify-center space-x-7 mt-3\">\r\n        <Button\r\n          text={loading ? \"Updating...\" : \"Update\"}\r\n          onClick={handleUpdate}\r\n          disabled={loading}\r\n          className=\"px-6 py-3\"\r\n        />\r\n        <Button\r\n          text=\"Cancel\"\r\n          onClick={() => navigate(-1)}\r\n          variant=\"secondary\"\r\n          className=\"px-6 py-2\"\r\n        />\r\n      </div>\r\n\r\n      {popupMessage && (\r\n        <Popup\r\n          open={true}\r\n          onClose={() => setPopupMessage(null)}\r\n          closeOnDocumentClick\r\n        >\r\n          <div className=\"w-full text-center p-4 rounded-lg shadow-lg\">\r\n            {popupMessage}\r\n            <Button text=\"OK\" onClick={() => setPopupMessage(null)} />\r\n          </div>\r\n        </Popup>\r\n      )}\r\n\r\n      {showConfirmation && (\r\n        <Popup\r\n          open={true}\r\n          onClose={() => setShowConfirmation(false)}\r\n          closeOnDocumentClick\r\n        >\r\n          <div className=\"w-full text-center p-4 rounded-lg shadow-lg\">\r\n            <p>Are you sure you want to change your password?</p>\r\n            <div className=\"mt-4 gap-x-4 flex justify-around\">\r\n              <Button text=\"Confirm\" onClick={confirmUpdate} />\r\n              <Button\r\n                text=\"Cancel\"\r\n                onClick={() => setShowConfirmation(false)}\r\n              />\r\n            </div>\r\n          </div>\r\n        </Popup>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}